<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FaithPlates</title>
    <link rel="icon" href="favicon.ico" />
    <link rel="stylesheet" href="css/main.css" />
    <link rel="stylesheet" href="css/home-and-explore.css" />
  </head>
  <body>
    <header>
      <div class="left-container">
        <div class="logo">
          <img src="icon.png" width="50" height="60" />
        </div>
        <div class="header-text">
          <h1>Jacob Drake</h1>
        </div>
      </div>
      <div class="nav-buttons">
        <nav>
          <menu>
            <li class="nav-item"><a href="home.html">Home</a></li>
            <li class="nav-item"><a href="compose.html">Compose</a></li>
            <li class="nav-item"><a href="explore.html">Explore</a></li>
            <li class="nav-item"><a href="index.html">Logout</a></li>
          </menu>
        </nav>
      </div>
    </header>

    <main>
      <!-- I will make item containers look much better later -->
      <div class="items-view">
        <div class="notification-container">
          <h2>Notifications</h2>
          <div class="item-container">
            <p>Friend 1 has shared a study</p>
            <button type="button">See page</button>
          </div>
          <div class="item-container">
            <p>Friend request</p>
            <button type="button">Accept</button>
            <button type="button">Decline</button>
          </div>
        </div>

        <div class="studies-container">
          <h2>My Studies</h2>
          <div id="studies-list"></div>
        </div>
      </div>
      <!-- When you click on one of the links in a study it will pull up here -->
      <div class="iframe-container">
        <iframe name="study-iframe" src="about:blank"></iframe>
      </div>
    </main>

    <footer>
      <hr />
      <span class="text-reset">Jacob Drake</span>
      <a href="https://github.com/Drake568/startup">GitHub</a>
    </footer>

    <script>
      // Function to display saved studies
      function displaySavedStudies() {
        const studiesList = document.getElementById("studies-list");

        // Clear the current list to avoid duplicates
        studiesList.innerHTML = "";

        // Retrieve saved data from localStorage
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);

          if (key.startsWith("Study-")) {
            const data = JSON.parse(localStorage.getItem(key));

            // Extract the timestamp from the key
            const timestamp = key.replace("Study-", "");

            // Create a new item container for each saved study
            const studyContainer = document.createElement("div");
            studyContainer.classList.add("item-container");

            // Create a header element to display the date
            const dateHeader = document.createElement("h3");
            dateHeader.textContent = new Date(
              parseInt(timestamp)
            ).toLocaleString();

            // Create a header element for notes
            const notesHeader = document.createElement("h4");
            notesHeader.textContent = "Notes";

            // Create a paragraph element to display the notes
            const notesParagraph = document.createElement("p");
            notesParagraph.textContent = data.notes;

            // Create a header element for links
            const linksHeader = document.createElement("h4");
            linksHeader.textContent = "Links";

            // Append the headers and notes to the study container
            studyContainer.appendChild(dateHeader);
            studyContainer.appendChild(notesHeader);
            studyContainer.appendChild(notesParagraph);
            studyContainer.appendChild(linksHeader);

            // Create link elements for each saved link
            data.links.forEach(function (link) {
              if (link.trim() !== "") {
                const linkElement = document.createElement("a");
                linkElement.href = link;
                linkElement.textContent = link;
                linkElement.target = "study-iframe";
                linkElement.classList.add("study-link");
                studyContainer.appendChild(linkElement);
              }
            });

            // Append the study container to the studies list
            studiesList.appendChild(studyContainer);
          }
        }
      }

      // Call the function to display saved studies when the page loads
      displaySavedStudies();
    </script>
  </body>
</html>
